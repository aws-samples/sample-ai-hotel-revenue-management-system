{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Hotel Revenue Optimization Response Schema",
  "description": "Schema for responses from the Hotel Revenue Optimization system, including handling for partial results",
  "type": "object",
  "required": ["status", "completed_tasks", "failed_tasks", "results", "metadata"],
  "properties": {
    "status": {
      "type": "string",
      "description": "Status of the overall operation",
      "enum": ["success", "partial_success", "failure"]
    },
    "completed_tasks": {
      "type": "array",
      "description": "List of tasks that completed successfully",
      "items": {
        "type": "string"
      }
    },
    "failed_tasks": {
      "type": "array",
      "description": "List of tasks that failed to complete",
      "items": {
        "type": "string"
      }
    },
    "results": {
      "type": "object",
      "description": "Results from all tasks, including placeholders for failed tasks",
      "additionalProperties": {
        "oneOf": [
          {
            "type": "object",
            "description": "Result from a successful task",
            "required": ["output"],
            "properties": {
              "output": {
                "type": "string",
                "description": "Output from the task"
              },
              "additional_data": {
                "type": "object",
                "description": "Additional data from the task"
              }
            }
          },
          {
            "type": "object",
            "description": "Placeholder for a failed task",
            "required": ["placeholder", "error"],
            "properties": {
              "placeholder": {
                "type": "string",
                "description": "Placeholder message for the failed task"
              },
              "error": {
                "type": "string",
                "description": "Error message from the failed task"
              },
              "error_details": {
                "type": "object",
                "description": "Additional error details"
              }
            }
          }
        ]
      }
    },
    "metadata": {
      "type": "object",
      "description": "Metadata about the operation",
      "required": ["run_id", "start_time", "end_time", "duration_seconds"],
      "properties": {
        "run_id": {
          "type": "string",
          "description": "Unique identifier for the run"
        },
        "start_time": {
          "type": "string",
          "format": "date-time",
          "description": "Start time of the operation in ISO 8601 format"
        },
        "end_time": {
          "type": "string",
          "format": "date-time",
          "description": "End time of the operation in ISO 8601 format"
        },
        "duration_seconds": {
          "type": "number",
          "description": "Duration of the operation in seconds"
        },
        "model_usage": {
          "type": "object",
          "description": "Model usage statistics",
          "properties": {
            "total_input_tokens": {
              "type": "integer",
              "description": "Total number of input tokens used"
            },
            "total_output_tokens": {
              "type": "integer",
              "description": "Total number of output tokens used"
            },
            "model_calls": {
              "type": "integer",
              "description": "Total number of model calls made"
            },
            "rate_limit_events": {
              "type": "integer",
              "description": "Number of rate limit events encountered"
            },
            "fallback_events": {
              "type": "integer",
              "description": "Number of model fallback events"
            }
          }
        },
        "performance": {
          "type": "object",
          "description": "Performance statistics",
          "properties": {
            "task_durations": {
              "type": "object",
              "description": "Duration of each task in seconds",
              "additionalProperties": {
                "type": "number"
              }
            },
            "model_latencies": {
              "type": "object",
              "description": "Average latency for each model in seconds",
              "additionalProperties": {
                "type": "number"
              }
            }
          }
        }
      }
    },
    "report": {
      "type": "string",
      "description": "The generated revenue optimization report (if available)"
    }
  },
  "examples": [
    {
      "status": "success",
      "completed_tasks": ["market_analysis_task", "demand_forecast_task", "pricing_strategy_task", "revenue_management_task"],
      "failed_tasks": [],
      "results": {
        "market_analysis_task": {
          "output": "Market analysis report content..."
        },
        "demand_forecast_task": {
          "output": "Demand forecast report content..."
        },
        "pricing_strategy_task": {
          "output": "Pricing strategy report content..."
        },
        "revenue_management_task": {
          "output": "Revenue management report content..."
        }
      },
      "metadata": {
        "run_id": "550e8400-e29b-41d4-a716-446655440000",
        "start_time": "2025-07-21T01:23:45Z",
        "end_time": "2025-07-21T01:25:12Z",
        "duration_seconds": 87.5,
        "model_usage": {
          "total_input_tokens": 12500,
          "total_output_tokens": 8750,
          "model_calls": 24,
          "rate_limit_events": 0,
          "fallback_events": 0
        },
        "performance": {
          "task_durations": {
            "market_analysis_task": 15.2,
            "demand_forecast_task": 18.7,
            "pricing_strategy_task": 22.1,
            "revenue_management_task": 25.3
          },
          "model_latencies": {
            "anthropic.claude-3-haiku-20240307-v1:0": 2.3,
            "anthropic.claude-3-sonnet-20240229-v1:0": 3.1
          }
        }
      },
      "report": "# Hotel Revenue Optimization Plan\n\n## Executive Summary\n..."
    },
    {
      "status": "partial_success",
      "completed_tasks": ["market_analysis_task", "demand_forecast_task"],
      "failed_tasks": ["pricing_strategy_task", "revenue_management_task"],
      "results": {
        "market_analysis_task": {
          "output": "Market analysis report content..."
        },
        "demand_forecast_task": {
          "output": "Demand forecast report content..."
        },
        "pricing_strategy_task": {
          "placeholder": "Task pricing_strategy_task failed to complete",
          "error": "Model invocation failed after multiple retries",
          "error_details": {
            "error_code": "ThrottlingException",
            "retry_attempts": 5,
            "model_id": "anthropic.claude-3-sonnet-20240229-v1:0"
          }
        },
        "revenue_management_task": {
          "placeholder": "Task revenue_management_task failed to complete",
          "error": "Task dependency failed",
          "error_details": {
            "failed_dependency": "pricing_strategy_task"
          }
        }
      },
      "metadata": {
        "run_id": "550e8400-e29b-41d4-a716-446655440001",
        "start_time": "2025-07-21T02:23:45Z",
        "end_time": "2025-07-21T02:24:35Z",
        "duration_seconds": 50.2,
        "model_usage": {
          "total_input_tokens": 5200,
          "total_output_tokens": 3800,
          "model_calls": 12,
          "rate_limit_events": 5,
          "fallback_events": 2
        },
        "performance": {
          "task_durations": {
            "market_analysis_task": 15.8,
            "demand_forecast_task": 19.2,
            "pricing_strategy_task": 15.2
          },
          "model_latencies": {
            "anthropic.claude-3-haiku-20240307-v1:0": 2.5,
            "anthropic.claude-3-sonnet-20240229-v1:0": 3.3
          }
        }
      }
    }
  ]
}
